{"ast":null,"code":"// // frontend/src/pages/VerifyCodeAccount.jsx\n\n// import React, { useState, useEffect } from 'react';\n// import { useNavigate, useLocation } from 'react-router-dom';\n// import { handleSuccess, handleError, ToastContainer } from '../utils/ReactToastify';\n// import '../utils/ReactToastifyCustom.css';\n// import '../utils/style/SentOtpForgotPassword.css';\n// import OtpInput from '../Services/OtpInput';\n\n// function VerifyCodeConfirmAccount() {\n//     const [otp, setOtp] = useState('');\n//     const [timer, setTimer] = useState(60);\n//     const [isResendEnabled, setIsResendEnabled] = useState(false);\n//     const [isComplete, setIsComplete] = useState(false);\n//     // const [isVerified, setIsVerified] = useState(false); // Track OTP verification status\n//     const [hasCodeBeenSent, setHasCodeBeenSent] = useState(false); // Track if code has been sent\n//     const { state } = useLocation(); // Get email from location state\n//     const navigate = useNavigate();\n\n//     // Handle countdown timer\n//     useEffect(() => {\n//         const countdown = timer > 0 ? setInterval(() => {\n//             setTimer((prev) => prev - 1);\n//         }, 1000) : null;\n\n//         if (timer === 0) {\n//             setIsResendEnabled(true);\n//         }\n\n//         return () => {\n//             if (countdown) clearInterval(countdown);\n//         };\n//     }, [timer]);\n\n//     // // Auto-login if OTP is verified\n//     // useEffect(() => {\n//     //     if (isVerified) {\n//     //         const refreshToken = localStorage.getItem('refreshToken');\n//     //         if (refreshToken) {\n//     //             (async () => {\n//     //                 try {\n//     //                     const response = await fetch(\"http://localhost:8080/auth/refresh-token\", {\n//     //                         method: 'POST',\n//     //                         headers: {\n//     //                             'Content-Type': 'application/json',\n//     //                         },\n//     //                         body: JSON.stringify({ refreshToken }),\n//     //                     });\n//     //                     const result = await response.json();\n//     //                     if (response.ok) {\n//     //                         localStorage.setItem('token', result.accessToken);\n//     //                         localStorage.setItem('refreshToken', result.refreshToken);\n//     //                         localStorage.setItem('loggedInUser', JSON.stringify(result));\n//     //                         handleSuccess('Auto-login successful!');\n//     //                         navigate('/home');\n//     //                     } else {\n//     //                         handleError(result.message || 'Failed to auto-login.');\n//     //                     }\n//     //                 } catch (err) {\n//     //                     handleError('Network error. Please check your connection and try again.');\n//     //                 }\n//     //             })();\n//     //         }\n//     //     }\n//     // }, [isVerified, navigate]);\n\n//     const handleSubmit = async (event) => {\n//         event.preventDefault();\n//         try {\n//             const token = localStorage.getItem('token'); // Get the token from localStorage\n//             const response = await fetch('http://localhost:8080/auth/verify-email', {\n//                 method: 'POST',\n//                 headers: { \n//                     'Content-Type': 'application/json',\n//                     'Authorization': `Bearer ${token}` // Add the token to the Authorization header\n//                 },\n//                 body: JSON.stringify({ email: state.email, code: otp }),\n//             });\n\n//             const result = await response.json();\n\n//             if (response.ok) {\n//                 handleSuccess(result.message);\n//             } else {\n//                 handleError(result.message);\n//             }\n//         } catch (err) {\n//             handleError('Network error. Please check your connection and try again.');\n//         }\n//     };\n\n//     const handleSendOtp = async () => {\n//         try {\n//             setHasCodeBeenSent(true);\n//             setIsResendEnabled(false);\n//             setTimer(60); // Reset timer\n//             const token = localStorage.getItem('token'); // Get the token from localStorage\n//             const response = await fetch('http://localhost:8080/auth/verify-email', {\n//                 method: 'POST',\n//                 headers: { \n//                     'Content-Type': 'application/json',\n//                     'Authorization': `Bearer ${token}` // Add the token to the Authorization header\n//                 },\n//                 body: JSON.stringify({ email: state.email }),\n//             });\n\n//             const result = await response.json();\n\n//             if (response.ok) {\n//                 handleSuccess(result.message);\n//             } else {\n//                 handleError(result.message);\n//             }\n//         } catch (err) {\n//             handleError('Failed to send OTP. Please try again.');\n//         }\n//     };\n\n//     const handleResendOtp = async () => {\n//         try {\n//             setIsResendEnabled(false);\n//             setTimer(60); // Reset timer\n//             const token = localStorage.getItem('token'); // Get the token from localStorage\n//             const response = await fetch('http://localhost:8080/auth/verify-email', {\n//                 method: 'POST',\n//                 headers: { \n//                     'Content-Type': 'application/json',\n//                     'Authorization': `Bearer ${token}` // Add the token to the Authorization header\n//                 },\n//                 body: JSON.stringify({ email: state.email }),\n//             });\n\n//             const result = await response.json();\n\n//             if (response.ok) {\n//                 handleSuccess(result.message);\n//             } else {\n//                 handleError(result.message);\n//             }\n//         } catch (err) {\n//             handleError('Failed to resend OTP. Please try again.');\n//         }\n//     };\n\n//     return (\n//         <div className=\"otp-wrapper\">\n//             <div>\n//                 <img src='/app-icon.ico' alt='App Icon' className='app-icon' />\n//             </div>\n//             <h1 className=\"otp-title\">Verification Code</h1>\n//             <div className=\"otp-timer\">\n//                 {hasCodeBeenSent ? (\n//                     <p>We've sent a verification code to your registered email address.</p>\n//                 ) : (\n//                     <p>Click the button to send the verification code to your email.</p>\n//                 )}\n//                 <div className=\"timer\">\n//                     <p>Time Remaining: {timer} s</p>\n//                 </div>\n//             </div>\n//             <form onSubmit={handleSubmit}>\n//                 {!hasCodeBeenSent ? (\n//                     <button\n//                         type=\"button\"\n//                         className=\"otp-btn send\"\n//                         onClick={handleSendOtp}\n//                     >\n//                         Send Code\n//                     </button>\n//                 ) : (\n//                     <OtpInput\n//                         length={6}\n//                         onOtpSubmit={(otp) => setOtp(otp)}\n//                         onOtpComplete={(complete) => setIsComplete(complete)}\n//                     />\n//                 )}\n//                 <div className=\"otp-buttons\">\n//                     {timer === 0 && isResendEnabled ? (\n//                         <>\n//                             <div className=\"otp-message\">\n//                                 <p>Didn't receive the code?</p>\n//                             </div>\n//                             <button\n//                                 type=\"button\"\n//                                 className=\"otp-btn resend\"\n//                                 onClick={handleResendOtp}\n//                             >\n//                                 Resend Code\n//                             </button>\n//                         </>\n//                     ) : hasCodeBeenSent ? (\n//                         <>\n//                             <div className=\"otp-message\">\n//                                 <br />\n//                             </div>\n//                             <button\n//                                 type=\"submit\"\n//                                 className={`otp-btn verify ${isComplete ? 'active' : ''}`}\n//                                 disabled={!isComplete}\n//                             >\n//                                 Verify Code\n//                             </button>\n//                         </>\n//                     ) : null}\n//                 </div>\n//             </form>\n//             <ToastContainer />\n//         </div>\n//     );\n// }\n\n// export default VerifyCodeConfirmAccount;","map":{"version":3,"names":[],"sources":["C:/Users/thesh/Desktop/Authentication/frontend/src/pages/VerifyCodeAccount.jsx"],"sourcesContent":["// // frontend/src/pages/VerifyCodeAccount.jsx\r\n\r\n// import React, { useState, useEffect } from 'react';\r\n// import { useNavigate, useLocation } from 'react-router-dom';\r\n// import { handleSuccess, handleError, ToastContainer } from '../utils/ReactToastify';\r\n// import '../utils/ReactToastifyCustom.css';\r\n// import '../utils/style/SentOtpForgotPassword.css';\r\n// import OtpInput from '../Services/OtpInput';\r\n\r\n// function VerifyCodeConfirmAccount() {\r\n//     const [otp, setOtp] = useState('');\r\n//     const [timer, setTimer] = useState(60);\r\n//     const [isResendEnabled, setIsResendEnabled] = useState(false);\r\n//     const [isComplete, setIsComplete] = useState(false);\r\n//     // const [isVerified, setIsVerified] = useState(false); // Track OTP verification status\r\n//     const [hasCodeBeenSent, setHasCodeBeenSent] = useState(false); // Track if code has been sent\r\n//     const { state } = useLocation(); // Get email from location state\r\n//     const navigate = useNavigate();\r\n\r\n//     // Handle countdown timer\r\n//     useEffect(() => {\r\n//         const countdown = timer > 0 ? setInterval(() => {\r\n//             setTimer((prev) => prev - 1);\r\n//         }, 1000) : null;\r\n\r\n//         if (timer === 0) {\r\n//             setIsResendEnabled(true);\r\n//         }\r\n\r\n//         return () => {\r\n//             if (countdown) clearInterval(countdown);\r\n//         };\r\n//     }, [timer]);\r\n\r\n//     // // Auto-login if OTP is verified\r\n//     // useEffect(() => {\r\n//     //     if (isVerified) {\r\n//     //         const refreshToken = localStorage.getItem('refreshToken');\r\n//     //         if (refreshToken) {\r\n//     //             (async () => {\r\n//     //                 try {\r\n//     //                     const response = await fetch(\"http://localhost:8080/auth/refresh-token\", {\r\n//     //                         method: 'POST',\r\n//     //                         headers: {\r\n//     //                             'Content-Type': 'application/json',\r\n//     //                         },\r\n//     //                         body: JSON.stringify({ refreshToken }),\r\n//     //                     });\r\n//     //                     const result = await response.json();\r\n//     //                     if (response.ok) {\r\n//     //                         localStorage.setItem('token', result.accessToken);\r\n//     //                         localStorage.setItem('refreshToken', result.refreshToken);\r\n//     //                         localStorage.setItem('loggedInUser', JSON.stringify(result));\r\n//     //                         handleSuccess('Auto-login successful!');\r\n//     //                         navigate('/home');\r\n//     //                     } else {\r\n//     //                         handleError(result.message || 'Failed to auto-login.');\r\n//     //                     }\r\n//     //                 } catch (err) {\r\n//     //                     handleError('Network error. Please check your connection and try again.');\r\n//     //                 }\r\n//     //             })();\r\n//     //         }\r\n//     //     }\r\n//     // }, [isVerified, navigate]);\r\n\r\n//     const handleSubmit = async (event) => {\r\n//         event.preventDefault();\r\n//         try {\r\n//             const token = localStorage.getItem('token'); // Get the token from localStorage\r\n//             const response = await fetch('http://localhost:8080/auth/verify-email', {\r\n//                 method: 'POST',\r\n//                 headers: { \r\n//                     'Content-Type': 'application/json',\r\n//                     'Authorization': `Bearer ${token}` // Add the token to the Authorization header\r\n//                 },\r\n//                 body: JSON.stringify({ email: state.email, code: otp }),\r\n//             });\r\n    \r\n//             const result = await response.json();\r\n    \r\n//             if (response.ok) {\r\n//                 handleSuccess(result.message);\r\n//             } else {\r\n//                 handleError(result.message);\r\n//             }\r\n//         } catch (err) {\r\n//             handleError('Network error. Please check your connection and try again.');\r\n//         }\r\n//     };\r\n    \r\n//     const handleSendOtp = async () => {\r\n//         try {\r\n//             setHasCodeBeenSent(true);\r\n//             setIsResendEnabled(false);\r\n//             setTimer(60); // Reset timer\r\n//             const token = localStorage.getItem('token'); // Get the token from localStorage\r\n//             const response = await fetch('http://localhost:8080/auth/verify-email', {\r\n//                 method: 'POST',\r\n//                 headers: { \r\n//                     'Content-Type': 'application/json',\r\n//                     'Authorization': `Bearer ${token}` // Add the token to the Authorization header\r\n//                 },\r\n//                 body: JSON.stringify({ email: state.email }),\r\n//             });\r\n    \r\n//             const result = await response.json();\r\n    \r\n//             if (response.ok) {\r\n//                 handleSuccess(result.message);\r\n//             } else {\r\n//                 handleError(result.message);\r\n//             }\r\n//         } catch (err) {\r\n//             handleError('Failed to send OTP. Please try again.');\r\n//         }\r\n//     };\r\n    \r\n//     const handleResendOtp = async () => {\r\n//         try {\r\n//             setIsResendEnabled(false);\r\n//             setTimer(60); // Reset timer\r\n//             const token = localStorage.getItem('token'); // Get the token from localStorage\r\n//             const response = await fetch('http://localhost:8080/auth/verify-email', {\r\n//                 method: 'POST',\r\n//                 headers: { \r\n//                     'Content-Type': 'application/json',\r\n//                     'Authorization': `Bearer ${token}` // Add the token to the Authorization header\r\n//                 },\r\n//                 body: JSON.stringify({ email: state.email }),\r\n//             });\r\n    \r\n//             const result = await response.json();\r\n    \r\n//             if (response.ok) {\r\n//                 handleSuccess(result.message);\r\n//             } else {\r\n//                 handleError(result.message);\r\n//             }\r\n//         } catch (err) {\r\n//             handleError('Failed to resend OTP. Please try again.');\r\n//         }\r\n//     };\r\n    \r\n\r\n//     return (\r\n//         <div className=\"otp-wrapper\">\r\n//             <div>\r\n//                 <img src='/app-icon.ico' alt='App Icon' className='app-icon' />\r\n//             </div>\r\n//             <h1 className=\"otp-title\">Verification Code</h1>\r\n//             <div className=\"otp-timer\">\r\n//                 {hasCodeBeenSent ? (\r\n//                     <p>We've sent a verification code to your registered email address.</p>\r\n//                 ) : (\r\n//                     <p>Click the button to send the verification code to your email.</p>\r\n//                 )}\r\n//                 <div className=\"timer\">\r\n//                     <p>Time Remaining: {timer} s</p>\r\n//                 </div>\r\n//             </div>\r\n//             <form onSubmit={handleSubmit}>\r\n//                 {!hasCodeBeenSent ? (\r\n//                     <button\r\n//                         type=\"button\"\r\n//                         className=\"otp-btn send\"\r\n//                         onClick={handleSendOtp}\r\n//                     >\r\n//                         Send Code\r\n//                     </button>\r\n//                 ) : (\r\n//                     <OtpInput\r\n//                         length={6}\r\n//                         onOtpSubmit={(otp) => setOtp(otp)}\r\n//                         onOtpComplete={(complete) => setIsComplete(complete)}\r\n//                     />\r\n//                 )}\r\n//                 <div className=\"otp-buttons\">\r\n//                     {timer === 0 && isResendEnabled ? (\r\n//                         <>\r\n//                             <div className=\"otp-message\">\r\n//                                 <p>Didn't receive the code?</p>\r\n//                             </div>\r\n//                             <button\r\n//                                 type=\"button\"\r\n//                                 className=\"otp-btn resend\"\r\n//                                 onClick={handleResendOtp}\r\n//                             >\r\n//                                 Resend Code\r\n//                             </button>\r\n//                         </>\r\n//                     ) : hasCodeBeenSent ? (\r\n//                         <>\r\n//                             <div className=\"otp-message\">\r\n//                                 <br />\r\n//                             </div>\r\n//                             <button\r\n//                                 type=\"submit\"\r\n//                                 className={`otp-btn verify ${isComplete ? 'active' : ''}`}\r\n//                                 disabled={!isComplete}\r\n//                             >\r\n//                                 Verify Code\r\n//                             </button>\r\n//                         </>\r\n//                     ) : null}\r\n//                 </div>\r\n//             </form>\r\n//             <ToastContainer />\r\n//         </div>\r\n//     );\r\n// }\r\n\r\n// export default VerifyCodeConfirmAccount;\r\n"],"mappings":"AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}